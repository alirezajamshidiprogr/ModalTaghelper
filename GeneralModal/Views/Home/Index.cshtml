@using GeneralModal.Models
@using GeneralModal.TagHelper

<!-- CSS Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384‑sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous">

<!-- JS Bundle Bootstrap (شامل Popper و سایر پلاگین‌ها) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384‑FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>



@{
    var modal = new GenericModalBuilder("myModal")
        .Title("مدال نمونه") // اگر HeaderHtml ندادید، Title نمایش داده می‌شود
        .HeaderHtml("<h5 class='modal-title'>عنوان دلخواه هدر</h5>") // HTML دلخواه هدر
        .Size("lg")
        .EnableValidation(true) // <-- فعال کردن validation
        .BodyHtml(
    new TextBox { Id = "txtName", LabelText = "نام ", Class = "form-control", Placeholder = "نام خود را وارد کنید", Required = true, MinLength = 3, MaxLength = 50, ValidationMessage = "نام باید بین 3 تا 50 کاراکتر باشد." },
    new TextBox { Id = "txtEmail", Class = "form-control", Placeholder = "ایمیل خود را وارد کنید", Required = true, Pattern = @"^[^@\s]+@[^@\s]+\.[^@\s]+$", ValidationMessage = "ایمیل نامعتبر است." },
    new PasswordBox { Id = "txtPassword", Class = "form-control", Placeholder = "رمز عبور", Required = true, MinLength = 6, ValidationMessage = "رمز عبور حداقل 6 کاراکتر باشد." },
    new TextArea { Id = "txtMessage", Class = "form-control", Placeholder = "پیام خود را وارد کنید", Rows = 4 },
    new CheckBox { Id = "chkAgree", Class = "form-check-input", Required = true, ValidationMessage = "باید تیک توافق را بزنید." },
    new Select
            {
                Id = "status",
                Name = "status",
                LabelText = "وضعیت",
                Required = true,
                Items = new List<ListItem> {
            new ListItem("1", "فعال"),
            new ListItem("0", "غیرفعال")
                        },
                SelectedValues = new List<string> { "1" }
            },
    new MultiSelect
            {
                Id = "multiSelectRoles",
                Name = "roles",
                LabelText = "نقش‌ها",
                Required = true,
                Items = new List<ListItem> {
            new ListItem("admin", "مدیر"),
            new ListItem("editor", "ویراستار"),
            new ListItem("user", "کاربر عادی")
                        },
                SelectedValues = new List<string> { "user", "editor" },
                UseSelect2 = false // اگر می‌خواید select2 استفاده شود، true کنید
            }
        )

        .FooterHtml(@"<button class='btn btn-primary' onclick='submitModalForm()'>ثبت</button>")
        .Build();
}

@modal
<script>
    function submitModalForm() {
        var isValid = IsValidForm('myModal');
        if (!isValid) {
            alert('لطفاً تمام فیلدهای اجباری را کامل کنید!');
            return;
        }

        alert('فرم معتبر است، می‌توانید ادامه دهید!');
    }
</script>


<button class="btn btn-primary" onclick="openModal('myModal')">
    باز کردن مدال Fluent
</button>


<style>
    /* استایل خطای validation */
    .is-invalid {
        border-color: #dc3545;
        box-shadow: 0 0 0 0.2rem rgba(220,53,69,.25);
    }

    .form-check-input.is-invalid {
        outline: 0;
        border-color: #dc3545;
    }
</style>
